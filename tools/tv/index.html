<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ç”µè§†ç›´æ’­</title>

	<script>
		//è¯¥é¡µé¢ä»…é™åœ¨httpåè®®ä¸‹ä½¿ç”¨ï¼Œå¦åˆ™éƒ¨åˆ†æ¥å£ä¼šå—é™
		if(location.protocol=='https:'){
			location.protocol='http:';
		}
	</script>
	<style>
	*{margin:0;padding:0}.channel_logo{background-color:#778899;width:100px}#tv_list{display:none;top:0px;width:10%;float:right;height:95%;overflow:overlay;background-color:#121212;overflow-x:hidden;overflow-y:hidden}#tv_list:hover{overflow-y:auto;}iframe{width:90%;height:95%}select{font-size:20px;height:5%;width:50%;background-color:#121212;color:#bbbbbb;text-align:center;text-align-last:center;min-height:29.75px}@media all and (orientation:portrait){/* ç«–å± */ #tv_list{display:block;position:absolute;width:100%;top:35%}iframe{width:100%;height:30%}#tv_list dl{display:flex;vertical-align:middle}#tv_list dt{border-right:1px solid #606060;padding-right:5px;cursor:pointer} }@media all and (orientation:landscape){/* æ¨ªå± */ #tv_list{width:15%}iframe{width:85%}}select:hover{border:1px solid #9898d0;color:#0f0}select#channel{float:right}#tv_list dl{margin-left:5px;color:#bbbbbb;border-bottom:1px solid #606060;width:100%;overflow: auto;}#tv_list dl dd{margin:auto 0 auto 15px}#tv_list dl dd.haslogo{margin-bottom:-20px}#tv_list dl dd img{border-top:1px solid;border-bottom:17px solid;border-bottom-color:#fff}#tv_list dl a{color:#bbbbbb;text-decoration:none}#tv_list .active{margin:5px 0;background-color:#fff;border-radius:4px;animation:pulse 3s infinite}#tv_list::-webkit-scrollbar{width:4px;height:4px}#tv_list::-webkit-scrollbar-thumb{border-radius:5px;-webkit-box-shadow:inset 0 0 5px rgba(111,111,111,1);background:rgba(111,111,111,1)}#tv_list::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 5px rgba(0,0,0,0.2);border-radius:0;background:rgba(0,0,0,0.1)}@keyframes pulse{0%{box-shadow:0 0 8px 6px #fff}50%{box-shadow:0 0 8px 6px #9976ef}100%{box-shadow:0 0 8px 6px #fff}}@keyframes blink-smooth{0%{box-shadow:0 0 8px 6px #cc87e8}50%{box-shadow:0 0 8px 6px #b74cc4}100%{box-shadow:0 0 8px 6px #cc87e8}}.birth{float:left;position:fixed;bottom:10px;padding:0 5px;background-color:#b78cf0;border-radius:4px;animation:blink-smooth 3s infinite;z-index:10;}#tv_list dd div{top:-21px;position:relative;width:80%;background-color:#7c6a6a;opacity:0.9;padding:0 3px;overflow:hidden;height:22px}#tv_list dd div .animation{animation:3s wordsLoop linear infinite normal;color:#fff;vertical-align:middle}@keyframes wordsLoop{0%{transform:translate3d(0,5px,0);-webkit-transform:translate3d(0,5px,0)}100%{transform:translate3d(0,-110%,0);-webkit-transform:translate3d(0,-110%,0)}}@-webkit-keyframes wordsLoop{0%{transform:translate3d(0,5px,0);-webkit-transform:translate3d(0,5px,0)}100%{transform:translate3d(0,-110%,0);-webkit-transform:translate3d(0,-110%,0)}}.heart{width:10px;height:10px;position:fixed;transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg)}.heart:after,.heart:before{content:'';width:inherit;height:inherit;background:inherit;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;position:fixed}.heart:after{top:-5px}.heart:before{left:-5px}	
	</style>

	<!--//https://cdn.staticfile.org/ -->
	<!--//https://cdn.bootcss.com/ -->
	<script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/blueimp-md5/2.12.0/js/md5.min.js"></script>
	<script src="https://www.bejson.com/static/bejson/js/component/convert/pinyin.js"></script>
	<script src="../js/file.js"></script>
	<script src="../js/heart.js"></script>
	<script src="../js/calendar.js"></script>
	<script src="../js/corsapi.js"></script>
	<script src="../js/tv.js"></script>
</head>
<body>
<div style="background-color:#121212;height:100%">
<div style="width:100%">
<select id="source" onchange="loadlist(this)"></select>
<select id="channel" onchange="loadchannel(this)"></select>
</div>
<h1></h1>
<div id="tv_list">
</div>
<div><div id="birthDiv"></div></div>
<iframe id="player" src="about:blank" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" 
msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" style="margin:0;border:0;"></iframe>
</div>
</body>
<script>

//------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------
//è·å–æŸ¥è¯¢å­—ç¬¦ä¸²
function getQueryString(name) {
	var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');
	var r = window.location.search.substr(1).match(reg);
	if (r != null)
		return decodeURIComponent(r[2]);
	return null;
}

//æ˜¯å¦æ˜¾ç¤ºlogoã€æ˜¯å¦ä¸ºæ‰‹æœºè®¿é—®
var isMobile=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent);
var showLogo=getQueryString('showLogo')|| false;
var lover=getQueryString('lover');

$(function(){

	//åŠ¨æ€åŠ è½½js
	var loadjs=['source.js','channel.js','site.js'];
	var needLoaded=loadjs.length;
	for(var i=0;i<loadjs.length;i++){
		$.getScript('../js/'+loadjs[i],function(){needLoaded--;});
	}
	var load_timer=setInterval(function(){
		//åˆ¤æ–­æ˜¯å¦åŠ è½½å®Œjs
		if(needLoaded>0){
			return;
		}
		window.clearInterval(load_timer);
		//åˆå§‹åŒ–å„ç»„ä»¶
		init();

		//æ·»åŠ é”®ç›˜æŒ‰é”®æ”¯æŒï¼Œåˆ‡æ¢select
		$(document).keydown(function(event){
		ã€€ã€€if(event.keyCode == 27){//æŒ‰ESCé”®
				//åˆ‡æ¢ç„¦ç‚¹
				if(document.activeElement.tagName==='SELECT'){
					if($('select#source')[0].selectedIndex>0){
						$('select#source').blur();
					}else if($('select#channel')[0].selectedIndex>0){
						$('select#channel').blur();
					}
				}else{
					if($('select#source')[0].selectedIndex>0){
						$('select#source').focus();
					}else if($('select#channel')[0].selectedIndex>0){
						$('select#channel').focus();
					}
				}
		ã€€ã€€}else if(event.keyCode == 37){//æŒ‰â†é”®
				$('select#source').focus();
				event.preventDefault();
			}else if(event.keyCode == 39){//æŒ‰â†’é”®
				$('select#channel').focus();
				event.preventDefault();
			}else if(event.keyCode == 38){//æŒ‰â†‘é”®
				if(document.activeElement.tagName!=='SELECT'){
					event.preventDefault();
					var len=$('dd a').length;
					var idx=$('dd a').index($('dd a.active'));
					if(idx<=0){
						if($('select#source')[0].selectedIndex>0){
							$('select#source').focus();
						}else if($('select#channel')[0].selectedIndex>0){
							$('select#channel').focus();
						}
					}else{
						$('dd a').eq(idx-1).trigger('click');
					}
					scroll();//è‡ªåŠ¨å®šä½å½“å‰æ’­æ”¾æº
				}
			}else if(event.keyCode == 40){//æŒ‰â†“é”®
				if(document.activeElement.tagName!=='SELECT'){
					event.preventDefault();
					var len=$('dd a').length;
					var idx=$('dd a').index($('dd a.active'));
					$('dd a').eq((idx+1)%len).trigger('click');
					scroll();//è‡ªåŠ¨å®šä½å½“å‰æ’­æ”¾æº
				}
			}else if(event.keyCode == 33){//æŒ‰PageUpé”®ï¼Œåˆ‡æ¢åˆ†ç»„
				event.preventDefault();
				if(document.activeElement.tagName!=='SELECT'){
					var len=$('#tv_list dl').length;
					var idx=$('#tv_list dl').index($('dd a.active').parents('dl'));
					if(idx<=0){
						if($('select#source')[0].selectedIndex>0){
							$('select#source').focus();
						}else if($('select#channel')[0].selectedIndex>0){
							$('select#channel').focus();
						}
					}else{
						$('#tv_list dl').eq(idx-1).find('a').first().trigger('click');
					}
					scroll();//è‡ªåŠ¨å®šä½å½“å‰æ’­æ”¾æº
				}
			}else if(event.keyCode == 34){//æŒ‰PageDowné”®ï¼Œåˆ‡æ¢åˆ†ç»„
				event.preventDefault();
				if(document.activeElement.tagName!=='SELECT'){
					var len=$('#tv_list dl').length;
					var idx=$('#tv_list dl').index($('dd a.active').parents('dl'));
					$('#tv_list dl').eq((idx+1)%len).find('a').first().trigger('click');
					scroll();//è‡ªåŠ¨å®šä½å½“å‰æ’­æ”¾æº
				}
		ã€€ã€€}
		});
	}, 100);

})

//è‡ªåŠ¨å®šä½å½“å‰æ’­æ”¾æº
function scroll(){
	if($('dd a.active').position().top-$('dd a.active').height()<0){
		//æ»šåŠ¨æ¡åœ¨ä¸Šé¢ï¼Œåˆ™è‡ªåŠ¨æ»šåŠ¨åˆ°å±å¹•é¡¶ç«¯
		$('#tv_list').scrollTop($('#tv_list').scrollTop()+$('dd a.active').position().top-$('dd a.active').height()-20);
	}else if($('dd a.active').position().top-$('#tv_list').height()>0){
		//æ»šåŠ¨æ¡åœ¨ä¸‹é¢ï¼Œåˆ™è‡ªåŠ¨æ»šåŠ¨åˆ°å±å¹•åº•ç«¯
		$('#tv_list').scrollTop($('#tv_list').scrollTop()+$('dd a.active').position().top-$('#tv_list').height()+25);
	}
}

function init(){

	//è·å–åŸå¸‚åˆ—è¡¨
	cities={åŒ—äº¬:'beijing',ä¸Šæµ·:'shanghai',å¤©æ´¥:'tianjin',é‡åº†:'chongqing',é¦™æ¸¯:'xianggang',æ¾³é—¨:'aomen',å®‰å¾½:'anhui',ç¦å»º:'fujian',å¹¿ä¸œ:'guangdong',å¹¿è¥¿:'guangxi',è´µå·:'guizhou',ç”˜è‚ƒ:'gansu',æµ·å—:'hainan',æ²³åŒ—:'hebei',æ²³å—:'henan',é»‘é¾™æ±Ÿ:'heilongjiang',æ¹–åŒ—:'hubei',æ¹–å—:'hunan',å‰æ—:'jilin',æ±Ÿè‹:'jiangsu',æ±Ÿè¥¿:'jiangxi',è¾½å®:'liaoning',å†…è’™å¤:'neimenggu',å®å¤:'ningxia',é’æµ·:'qinghai',é™•è¥¿:'shanxi',å±±è¥¿:'shanxi',å±±ä¸œ:'shandong',å››å·:'sichuan',å°æ¹¾:'taiwan',è¥¿è—:'xizang',æ–°ç–†:'xinjiang',äº‘å—:'yunnan',æµ™æ±Ÿ:'zhejiang',å®‰åº†:'anqing',äº³å·:'bozhou',èšŒåŸ :'bangbu',æ± å·:'chizhou',å·¢æ¹–:'chaohu',æ»å·:'chuzhou',é˜œé˜³:'fuyang',åˆè‚¥:'hefei',æ·®å—:'huainan',æ·®åŒ—:'huaibei',é»„å±±:'huangshan',å…­å®‰:'liuan',é©¬éå±±:'maanshan',å®¿å·:'suzhou',é“œé™µ:'tongling',èŠœæ¹–:'wuhu',å®£åŸ:'xuancheng',ç¦å·:'fuzhou',é¾™å²©:'longyan',å—å¹³:'nanping',å®å¾·:'ningde',è†ç”°:'putian',æ³‰å·:'quanzhou',ä¸‰æ˜:'sanxing',å¦é—¨:'xiamen',æ¼³å·:'zhangzhou',æ½®å·:'chaozhou',ä¸œè:'dongguan',ä½›å±±:'foshan',å¹¿å·:'guangzhou',æ²³æº:'heyuan',æƒ å·:'huizhou',æ±Ÿé—¨:'jiangmen',æ­é˜³:'jieyang',æ¢…å·:'meizhou',èŒ‚å:'maoming',æ¸…è¿œ:'qingyuan',æ·±åœ³:'shenzhen',æ±•å¤´:'shantou',éŸ¶å…³:'shaoguan',æ±•å°¾:'shanwei',äº‘æµ®:'yunfu',é˜³æ±Ÿ:'yangjiang',ç æµ·:'zhuhai',ä¸­å±±:'zhongshan',è‚‡åº†:'zhaoqing',æ¹›æ±Ÿ:'zhanxiang',åŒ—æµ·:'beihai',ç™¾è‰²:'baise',å´‡å·¦:'chongzuo',é˜²åŸæ¸¯:'fangchenggang',æ¡‚æ—:'guili',è´µæ¸¯:'guigang',è´ºå·:'hezhou',æ²³æ± :'hechi',æŸ³å·:'liuzhou',æ¥å®¾:'laibin',å—å®:'nanning',é’¦å·:'qinzhou',æ¢§å·:'wuzhou',ç‰æ—:'yulin',å®‰é¡º:'anshun',è´µé˜³:'guiyang',å…­ç›˜æ°´:'liupanshui',éµä¹‰:'zunyi',ç™½é“¶:'baiyin',é‡‘æ˜Œ:'jinchang',å˜‰å³ªå…³:'jiayuguan',é…’æ³‰:'jiuquan',å…°å·:'lanzhou',åº†é˜³:'qingyang',å¤©æ°´:'tianshui',æ­¦å¨:'wuwei',å¼ æ–:'zhangye',æµ·å£:'haikou',ä¸‰äºš:'sanya',ä¿å®š:'baoding',æ‰¿å¾·:'chengde',æ²§å·:'cangzhou',é‚¯éƒ¸:'handan',è¡¡æ°´:'hengshui',å»ŠåŠ:'langfang',ç§¦çš‡å²›:'qinhuangdao',çŸ³å®¶åº„:'shijiazhuang',å”å±±:'tangshan',é‚¢å°:'xingtai',å¼ å®¶å£:'zhangjiakou',å®‰é˜³:'anyang',ç„¦ä½œ:'jiaozuo',å¼€å°:'kaifeng',æ´›é˜³:'luoyang',é¹¤å£:'hebi',æ¼¯æ²³:'luohe',å—é˜³:'nanyang',å¹³é¡¶å±±:'pingdingshan',æ¿®é˜³:'puyang',ä¸‰é—¨å³¡:'sanmenxia',å•†ä¸˜:'shangqiu',æ–°ä¹¡:'xinxiang',è®¸æ˜Œ:'xuchang',ä¿¡é˜³:'xinyang',éƒ‘å·:'zhengzhou',å‘¨å£:'zhoukou',é©»é©¬åº—:'zhumadian',å¤§åº†:'daqing',å“ˆå°”æ»¨:'haerbin',é¹¤å²—:'hegang',é»‘æ²³:'heihe',é¸¡è¥¿:'jixi',ä½³æœ¨æ–¯:'jiamusi',ç‰¡ä¸¹æ±Ÿ:'mudanjiang',é½é½å“ˆå°”:'qiqihaer',ä¸ƒå°æ²³:'qitaihe',ç»¥åŒ–:'suihua',åŒé¸­å±±:'shuangyashan',ä¼Šæ˜¥:'yichun',é„‚å·:'e\'zhou',é»„çŸ³:'huangshi',é»„å†ˆ:'huanggang',è†å·:'jingzhou',è†é—¨:'jingmen',åå °:'shiyan',æ­¦æ±‰:'wuhan',è¥„é˜³:'xiangyang',å­æ„Ÿ:'xiaogan',å’¸å®:'xianning',å®œæ˜Œ:'yichang',é•¿æ²™:'changsha',å¸¸å¾·:'changde',éƒ´å·:'chenzhou',è¡¡é˜³:'hengyang',æ€€åŒ–:'huaihua',å¨„åº•:'loudi',é‚µé˜³:'shaoyang',æ¹˜æ½­:'xiangtan',å²³é˜³:'yueyang',ç›Šé˜³:'yiyang',æ°¸å·:'yongzhou',æ ªæ´²:'zhuzhou',å¼ å®¶ç•Œ:'zhangjiajie',ç™½å±±:'baishan',ç™½åŸ:'baicheng',é•¿æ˜¥:'changchun',å‰æ—:'jilin',è¾½æº:'liaoyuan',å››å¹³:'siping',æ¾åŸ:'songyuan',é€šåŒ–:'tonghua',å¸¸å·:'changzhou',æ·®å®‰:'huaian',è¿äº‘æ¸¯:'lianyungang',å—äº¬:'nanjing',å—é€š:'nantong',è‹å·:'suzhou',å®¿è¿:'suqian',æ³°å·:'taizhou',æ— é”¡:'wuxi',å¾å·:'xuzhou',ç›åŸ:'yancheng',æ‰¬å·:'yangzhou',é•‡æ±Ÿ:'zhenjiang',æŠšå·:'fuzhou',èµ£å·:'ganzhou',æ™¯å¾·é•‡:'jingdezhen',ä¹æ±Ÿ:'jiujiang',å‰å®‰:'jian',å—æ˜Œ:'nanchang',èä¹¡:'pingxiang',ä¸Šé¥¶:'shangrao',æ–°ä½™:'xinyu',é¹°æ½­:'yingtan',å®œæ˜¥:'yichun',éå±±:'anshan',æœ¬æºª:'benxi',æœé˜³:'chaoyang',å¤§è¿:'dalian',ä¸¹ä¸œ:'dandong',æŠšé¡º:'fushun',é˜œæ–°:'fuxin',è‘«èŠ¦å²›:'huludao',é”¦å·:'jinzhou',è¾½é˜³:'liaoyang',ç›˜é”¦:'panjin',æ²ˆé˜³:'shenyang',é“å²­:'tieling',è¥å£:'yingkou',åŒ…å¤´:'baotou',èµ¤å³°:'chifeng',é„‚å°”å¤šæ–¯:'e\'erduosi',å‘¼å’Œæµ©ç‰¹:'huhehaote',é€šè¾½:'tongliao',ä¹Œæµ·:'wuhai',å›ºåŸ:'guyuan',å´å¿ :'wuzhong',é“¶å·:'yingchuan',è¥¿å®:'xining',å®‰åº·:'ankang',å®é¸¡:'baoji',æ±‰ä¸­:'hanzhong',å•†æ´›:'shangluo',é“œå·:'tongchuan',æ¸­å—:'weinan',è¥¿å®‰:'xi\'an',å»¶å®‰:'yanan',å’¸é˜³:'xianyang',æ¦†æ—:'yulin',é•¿æ²»:'changzhi',å¤§åŒ:'datong',æ™‹åŸ:'jincheng',ä¸´æ±¾:'linfen',æœ”å·:'shuozhou',å¤ªåŸ:'taiyuan',å¿»å·:'xinzhou',é˜³æ³‰:'yangquan',è¿åŸ:'yuncheng',æ»¨å·:'binzhou',ä¸œè¥:'dongying',å¾·å·:'dezhou',èæ³½:'heze',æµå—:'jinan',æµå®:'jining',è±èŠœ:'laiwu',ä¸´æ²‚:'linyi',èŠåŸ:'liaocheng',é’å²›:'qingdao',æ—¥ç…§:'rizhao',æ³°å®‰:'taian',æ½åŠ:'weifang',å¨æµ·:'weihai',çƒŸå°:'yantai',æ·„åš:'zibo',æ£åº„:'zaozhuang',å·´ä¸­:'bazhong',æˆéƒ½:'chengdu',å¾·é˜³:'deyang',è¾¾å·:'dazhou',å¹¿å…ƒ:'guangyuan',å¹¿å®‰:'guangan',æ³¸å·:'luzhou',ä¹å±±:'leshan',ç»µé˜³:'mianyang',çœ‰å±±:'meishan',å†…æ±Ÿ:'neijiang',å—å……:'nanchong',æ”€æèŠ±:'panzhihua',é‚å®:'suining',é›…å®‰:'yaan',å®œå®¾:'yibin',è‡ªè´¡:'zigong',èµ„é˜³:'ziyang',é«˜é›„:'gaoxiong',åŸºéš†:'jilong',å˜‰ä¹‰:'jiayi',å°åŒ—:'taibei',å°ä¸­:'taizhong',æ–°ç«¹:'xinzhu',æ‹‰è¨:'lasa',å…‹æ‹‰ç›ä¾:'kelamayi',ä¹Œé²æœ¨é½:'wulumuqi',ä¿å±±:'baoshan',æ˜†æ˜:'kunming',ç‰æºª:'yuxi',æ˜­é€š:'zhaotong',æ­å·:'hangzhou',æ¹–å·:'huzhou',å˜‰å…´:'jiaxing',é‡‘å:'jinhua',ä¸½æ°´:'lishui',å®æ³¢:'ningbo',è¡¢å·:'quzhou',ç»å…´:'shaoxing',å°å·:'taizhou',æ¸©å·:'wenzhou',èˆŸå±±:'zhoushan'};
	
	//å«è§†logo:http://www.tvyan.com/uploads/dianshi/cctv1.jpg
	if(showLogo)loadTVLogo();//åŠ è½½logoä¿¡æ¯
	
	//jquery å…¨å±€è®¾ç½®
	jQuery.ajaxPrefilter(function(options) {
		if (options.crossDomain && jQuery.support.cors) {
			if(options.url.includes('//raw.githubusercontent.com/')|| options.url.includes('//github.com/')){
				//è¯·æ±‚raw.githubusercontent.comã€github.comæ—¶ï¼Œ
				//åŸé“¾æ¥éœ€è¦åšä¿®æ”¹ï¼Œæ–¹èƒ½æ­£å¸¸ä¸‹è½½
				//	[1]. https://raw.githubusercontent.com/billy21/Tvlist-awesome-m3u-m3u8/master/README.md
				//  [2]. https://github.com/billy21/Tvlist-awesome-m3u-m3u8/blob/master/README.md
				//ä¿®æ”¹ä¸ºï¼šhttps://cdn.jsdelivr.net/gh/billy21/Tvlist-awesome-m3u-m3u8@master/README.md
				let s=options.url.split('/');
				options.url = 'https://cdn.jsdelivr.net/gh/' + s[3]+'/'+s[4]+'@'+s.slice((options.url.includes('//github.com/')?6:5)).join('/');
			}
			//options.url = 'https://cors-anywhere.herokuapp.com/' + options.url;
		}
	});
	
	//åŠ è½½ç›´æ’­æºselect
	$('select#source').html('<option selected>è¯·é€‰æ‹©ç›´æ’­æº</option>');
	$('select#source').append('<option value="" data-type="page" data-fun="loadCCTV">CCTVå®˜æ–¹ç›´æ’­æº</option>');
	$('select#source').append('<option value="http://ivi.bupt.edu.cn/" data-type="page" data-fun="loadYoudian">åŒ—äº¬é‚®ç”µå¤§å­¦ï¼ˆå®˜æ–¹ï¼‰</option>');
	$('select#source').append('<option value="https://ialaddin.github.io/iptv/categories/bgv.m3u" data-type="m3u">M3Uç²¾é€‰åˆ—è¡¨ï¼šçºªå½•ç‰‡/ç”µå½±/ç”µè§†å‰§</option>');
	$('select#source').append('<option value="https://raw.githubusercontent.com/EvilCult/iptv-m3u-maker/master/tv.m3u8" data-type="m3u">IPTV å›½å†…+å›½å¤– ç”µè§†å°ç›´æ’­æº</option>');
	$('select#source').append('<option value="https://raw.githubusercontent.com/iptv-org/iptv/master/channels/cn.m3u" data-type="m3u">IPTV IPTV-ä¸­æ–‡ç›´æ’­æº</option>');
	$('select#source').append('<option value="https://homenet6.github.io/list.txt" data-type="txt">å®¶åº­ç½‘ç»œèµ„æºå…±äº«ç¾¤ç»´æŠ¤çš„IPTVé¢‘é“åˆ—è¡¨</option>');
	
	//å¤šä¸ªç›´æ’­æºæ±‡æ€»ï¼šhttps://github.com/billy21/Tvlist-awesome-m3u-m3u8
	//$.get('https://raw.githubusercontent.com/billy21/Tvlist-awesome-m3u-m3u8/master/README.md',function(msg){
	$.get('https://github.com/billy21/Tvlist-awesome-m3u-m3u8/blob/master/README.md',function(msg){
		var list = msg.match(/- \[.*.m3u8\]\([^)]*\)/g);
		for(var i=0;i<list.length;i++){
			var item=list[i].match(/- \[(.*).m3u8\]\(([^)]*)\)/);
			$('select#source').append('<option value="'+item[2]+'" data-type="m3u">'+item[1]+'</option>');
		}
	});	

	//åŠ è½½é¢‘é“select
	$('select#channel').html('<option selected>è¯·é€‰æ‹©é¢‘é“</option>');
	
	for(var i=0;i<channels.length;i++){
		$('select#channel').append('<optgroup label="'+channels[i].name+'"></optgroup>');
		var group=$('select#channel optgroup:eq('+i+')');
		for(var j=0;j<channels[i].children.length;j++){
			group.append('<option value="'+j+'">'+channels[i].children[j]+'</option>');
		}
	}
	
	//é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªç›´æ’­æº
	if(lover=='guaiguai'){
		var lunar = calendar.solar2lunar();
		//åŠ è½½ä¸“å±é¢‘é“ï¼šæ¹–å—ã€æµ™æ±Ÿã€ä¸œæ–¹ã€æ±Ÿè‹å«è§†
		loadLoverChannels();
		var heartIdx=1;
		setInterval(function(){
			heartIdx = (heartIdx+1)%2;
			document.title='ä¹–ä¹–ä¸“å±é¢‘é“'+['ğŸ’•','ğŸ’“'][heartIdx];
		},500)
		;
		
		//æ˜¾ç¤ºç”Ÿæ—¥ç¥ç¦
		if(lunar.IMonthCn+lunar.IDayCn==='äºŒæœˆåˆä¸ƒ') {
			$.getScript('js/jquery.fireworks.js',function(){
				corsApi('https://antiserver.kuwo.cn/anti.s?rid=MUSIC_68691986&format=mp3|aac&type=convert_url&response=url',function(msg){
					var music=msg.split('').slice(2,-1).join('');
					$('#birthDiv').data('music',music); 
				},'html');
				$('#birthDiv').text('ç¥è€å©†ç”Ÿæ—¥å¿«ä¹~').addClass('birth').css('left',($(window).width()-$('#birthDiv').width())/2);
			});
		}
	}else{
		//æŒ‡å®šæ’­æ”¾æºï¼Œåˆ™è§£ææ’­æ”¾æº
		let url = location.search.substr(5);
		let paratype = location.search.substr(1,3).toLowerCase();
		if(paratype === 'm3u'){
			loadM3u(url,function(a,b){
				return a.group_title<b.group_title? -1 : 1; 
			});
		}else if(paratype ==='txt'){
			loadTxt(url);
		}else if(paratype === 'url'){
			let filetype = getQueryString(paratype).substr(-5).replace(/.*?\.|\?/g,'').toLowerCase();
			//æ ¹æ®åç¼€è¿›è¡Œåˆ¤æ–­
			if(filetype === 'm3u'){
				loadM3u(url,function(a,b){
					return a.group_title<b.group_title? -1 : 1; 
				});
			}else if(filetype === 'txt'){
				loadTxt(url);
			}else{
				load([{
					name:'æŒ‡å®šæ’­æ”¾æº',
					url:url
				}]);
			}
		}else if(isMobile){
			//ç§»åŠ¨ç«¯è®¿é—®
			$('select#source').get(0).selectedIndex=2;
			$('select#source').change();
		}else{
			$('select#channel').get(0).selectedIndex=1;
			$('select#channel').change();
		}
	}
	
	//æ³¨å†Œæ–‡ä»¶æ‹–åŠ¨ç›‘å¬
	document.addEventListener('dragover', handleDragOver, false);
	document.addEventListener('drop', handleFileSelect, false);
}

//è®°å½•å½“å‰çš„æ’­æ”¾ä¿¡æ¯
var _ifm;
//æš‚å­˜æ’­æ”¾ä¿¡æ¯ï¼Œæ¸…ç©ºæ ‡ç­¾
function hideTv(){
	var innerIfm=$('iframe').contents().find('iframe');
	_ifm={};
	if(innerIfm.length>0){//æœ‰å†…å®¹ï¼Œåˆ™æ¢å¤æ—¶é‡ç½®å†…å®¹ï¼Œ
		_ifm.type='src';
		_ifm.content=innerIfm.attr('src');
	}else{
		_ifm.type='html';
		_ifm.content=innerIfm.contents().find('body').html();
	}
	resetIframe();
}
//æ¢å¤æ’­æ”¾ä¿¡æ¯
function reShowTV(){
	if(t_audio){
		t_audio.volume=t_audio.volume/2;
		t_audio.pause();
	}
	if(_ifm){
		if(_ifm.type==='src'){
			playByIframe(_ifm.content);
		}else{
			playByVideoHtml(_ifm.content);
		}
	}
	console.log('--stop---')
}
//æ’­æ”¾
function playMusic(music){
	if(typeof t_audio==='undefined')t_audio = document.createElement('audio');	
	t_audio.src = music;
	t_audio.play();
}
//æ”¾çƒŸèŠ±
function fireworks() {
	if($.fn.fireworks && $('#birthDiv').siblings('canvas').length===0){
		hideTv();
		if($('#birthDiv').data('music')) playMusic($('#birthDiv').data('music'));
		$('#birthDiv').parent().fireworks({
		  sound:false,
		  closeAfter:23300,//20såè‡ªåŠ¨å…³é—­
		  closeAfterCall:reShowTV,
		  opacity: 0.9, 
		  width: '100%', 
		  height: '100%' 
		});
	}
}

// ç‚¹å‡»é¡µé¢ åœ¨é¼ æ ‡ä½ç½® å‡ºç°å¿ƒå½¢ çƒŸèŠ±    
$('#birthDiv').on('click',function(ev){
	fireworks();//çƒŸèŠ±
	// ç‚¹å‡»å¿ƒå½¢ï¼Œéšæœºå¤šä¸ª
	var _tmr=setInterval(function(){
		if($('#birthDiv').siblings('canvas').length>0){
			var _ev={};
			_ev.pageX=ev.pageX+Math.random()*20*[1,-1][parseInt(Math.random()*2)];
			_ev.pageY=ev.pageY+Math.random()*20*[1,-1][parseInt(Math.random()*2)];
			generateHeart(_ev);
		}else {
			clearInterval(_tmr);
			clearInterval(this);
		}
	}, 3000);
});
</script>
</html>